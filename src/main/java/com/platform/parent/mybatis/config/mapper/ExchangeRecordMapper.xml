<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.parent.mybatis.dao.ExchangeRecordMapper">
    <resultMap id="base" type="com.platform.parent.mybatis.bean.ExchangeRecord">
        <id property="id" column="exchange_id"/>
        <result property="from" column="from_id" />
        <result property="reason" column="reason" />
        <result property="userId" column="user_id"/>
        <result property="created" column="created"/>
        <result property="updated" column="updated" />
        <result property="status" column="status"/>
    </resultMap>
    <insert id="add" parameterType="com.platform.parent.mybatis.bean.ExchangeRecord" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO `exchange_record` (`from_id`, `reason`, `user_id`, `created`, `updated`, `status`)
        VALUES (#{from}, #{reason}, #{userId}, #{created}, #{updated}, #{status})
    </insert>
    <update id="update" parameterType="com.platform.parent.mybatis.bean.ComplaintRecord">
        UPDATE `exchange_record` SET `from_id` = #{from}, `updated` = now(), `status` = #{status}
    </update>
    <delete id="deleteByIds" parameterType="java.lang.String">
        DELETE FROM `exchange_record`
        <foreach collection="array" item="idItem" open="(" separator="," close=")" >
            WHERE `exchange_id` IN #{idItem}
        </foreach>
    </delete>
    <select id="findComplaintRecordUnhandled" resultMap="base">
        SELECT * FROM `exchange_record` er WHERE er.status = 0
    </select>
</mapper>